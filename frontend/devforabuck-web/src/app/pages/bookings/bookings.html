<!-- Restricted -->
<section class="restricted-view" *ngIf="notAllowed">
  <h2>üîí Access Denied</h2>
  <p>Please log in to create new booking and access your bookings.</p>
  <button class="btn-primary" (click)="login()">Log in</button>
  <a class="btn-secondary" routerLink="/">‚Üê Go Home</a>
</section>

<!-- Bookings -->
<section class="bookings" *ngIf="!notAllowed">
  <header class="bookings-header">
    <div class="title-group">
      <mat-icon class="header-icon">event_note</mat-icon>
      <h1>My Bookings</h1>
    </div>

    <div class="actions">
      <button mat-flat-button color="primary" class="create-btn" (click)="openBookingModal()">
        <mat-icon>add_circle</mat-icon>
        New Booking
      </button>

      <button mat-stroked-button class="export-btn" (click)="exportBookings()">
        <mat-icon>download</mat-icon>
        Export
      </button>
    </div>
  </header>


  <div class="table-card" *ngIf="!isLoading && bookings.length; else stateTpl">
    <table mat-table [dataSource]="bookings" class="mat-elevation-z1 minimal-table">

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let b">{{ b.name }}</td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let b">
          <a [href]="'mailto:' + b.email">{{ b.email }}</a>
        </td>
      </ng-container>

      <ng-container matColumnDef="stack">
        <th mat-header-cell *matHeaderCellDef>Stack</th>
        <td mat-cell *matCellDef="let b">{{ b.stack }}</td>
      </ng-container>

      <ng-container matColumnDef="experienceYears">
        <th mat-header-cell *matHeaderCellDef>Experience</th>
        <td mat-cell *matCellDef="let b">{{ b.experienceYears }} yrs</td>
      </ng-container>

      <ng-container matColumnDef="slotTime">
        <th mat-header-cell *matHeaderCellDef>Slot Time</th>
        <td mat-cell *matCellDef="let b">{{ b.slotTime | date:'MMM d, y, h:mm a' }}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="actions-col">Actions</th>
        <td mat-cell *matCellDef="let b" class="actions-col">
          <a *ngIf="b.resumeUrl" class="btn-secondary icon-btn" [href]="b.resumeUrl" download target="_blank" title="Download Resume">
            ‚¨áÔ∏è
          </a>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row        *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>

  <ng-template #stateTpl>
    <div class="state-wrap" *ngIf="isLoading; else emptyTpl">
      <mat-spinner diameter="36"></mat-spinner>
    </div>
  </ng-template>

  <ng-template #emptyTpl>
    <div class="empty-state">
      <h3>üìÖ No Bookings</h3>
      <p>You haven't scheduled any sessions yet.</p>
      <button mat-flat-button color="primary" class="btn-primary" (click)="openBookingModal()">‚ûï Book Now</button>
    </div>
  </ng-template>
</section>
